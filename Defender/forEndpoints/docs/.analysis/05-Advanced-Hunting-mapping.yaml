# 05-Advanced-Hunting-KQL.md Reference Consolidation Mapping
# Current: 40 references → Target: 15 references (62.5% reduction)

## URL Groupings
duplicate_groups:
  - url: https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-query-language
    primary_ref: 5
    duplicate_refs: [12, 13, 14, 16, 17, 20, 21, 22, 28, 39]
    count: 11
    description: "KQL Query Language Reference"
  
  - url: https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-deviceinfo-table
    primary_ref: 8
    duplicate_refs: [11, 24, 38]
    count: 4
    description: "DeviceInfo Table Schema"
  
  - url: https://learn.microsoft.com/en-us/kusto/query/?view=microsoft-fabric
    primary_ref: 7
    duplicate_refs: [15, 23]
    count: 3
    description: "Kusto Query Overview"
  
  - url: https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-overview
    primary_ref: 1
    duplicate_refs: [2, 34]
    count: 3
    description: "Advanced Hunting Overview"
  
  - url: https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-limits
    primary_ref: 29
    duplicate_refs: [35, 36]
    count: 3
    description: "Advanced Hunting Limits"
  
  - url: https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-best-practices
    primary_ref: 18
    duplicate_refs: [37, 40]
    count: 3
    description: "Advanced Hunting Best Practices"
  
  - url: https://learn.microsoft.com/en-us/defender-xdr/api-advanced-hunting
    primary_ref: 26
    duplicate_refs: [27]
    count: 2
    description: "Advanced Hunting API"
  
  - url: https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-schema-tables
    primary_ref: 6
    duplicate_refs: [31]
    count: 2
    description: "Advanced Hunting Schema Tables"
  
  - url: https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-query-results
    primary_ref: 3
    duplicate_refs: [25]
    count: 2
    description: "Query Results Handling"
  
  - url: https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-deviceprocessevents-table
    primary_ref: 10
    duplicate_refs: [19]
    count: 2
    description: "DeviceProcessEvents Table"

## Inline Citation Replacement Map
replacement_map:
  1 → 1   # Advanced Hunting Overview (PRIMARY)
  2 → 1   # Duplicate of [1]
  3 → 2   # Query Results (renumbered from 3)
  4 → 3   # M365 Permissions (renumbered from 4)
  5 → 4   # KQL Query Language (PRIMARY, renumbered from 5)
  6 → 5   # Schema Tables (PRIMARY, renumbered from 6)
  7 → 6   # Kusto Query Overview (PRIMARY, renumbered from 7)
  8 → 7   # DeviceInfo Table (PRIMARY, renumbered from 8)
  9 → 8   # DeviceNetworkInfo Table (renumbered from 9)
  10 → 9   # DeviceProcessEvents Table (PRIMARY, renumbered from 10)
  11 → 7   # Duplicate of [8] (DeviceInfo)
  12 → 4   # Duplicate of [5] (KQL)
  13 → 4   # Duplicate of [5] (KQL)
  14 → 4   # Duplicate of [5] (KQL)
  15 → 6   # Duplicate of [7] (Kusto)
  16 → 4   # Duplicate of [5] (KQL)
  17 → 4   # Duplicate of [5] (KQL)
  18 → 10  # Best Practices (PRIMARY, renumbered from 18)
  19 → 9   # Duplicate of [10] (DeviceProcessEvents)
  20 → 4   # Duplicate of [5] (KQL)
  21 → 4   # Duplicate of [5] (KQL)
  22 → 4   # Duplicate of [5] (KQL)
  23 → 6   # Duplicate of [7] (Kusto)
  24 → 7   # Duplicate of [8] (DeviceInfo)
  25 → 2   # Duplicate of [3] (Query Results)
  26 → 11  # API Advanced Hunting (PRIMARY, renumbered from 26)
  27 → 11  # Duplicate of [26] (API)
  28 → 4   # Duplicate of [5] (KQL)
  29 → 12  # Limits (PRIMARY, renumbered from 29)
  30 → 13  # KQL Quick Reference (renumbered from 30)
  31 → 5   # Duplicate of [6] (Schema Tables)
  32 → 14  # Kusto Tutorials (renumbered from 32)
  33 → 15  # GitHub Hunting Queries (renumbered from 33)
  34 → 1   # Duplicate of [1] (Overview)
  35 → 12  # Duplicate of [29] (Limits)
  36 → 12  # Duplicate of [29] (Limits)
  37 → 10  # Duplicate of [18] (Best Practices)
  38 → 7   # Duplicate of [8] (DeviceInfo)
  39 → 4   # Duplicate of [5] (KQL)
  40 → 10  # Duplicate of [18] (Best Practices)

## Final Reference List (15 unique URLs)
final_references:
  1: https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-overview
  2: https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-query-results
  3: https://learn.microsoft.com/en-us/defender-xdr/m365d-permissions
  4: https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-query-language
  5: https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-schema-tables
  6: https://learn.microsoft.com/en-us/kusto/query/?view=microsoft-fabric
  7: https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-deviceinfo-table
  8: https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-devicenetworkinfo-table
  9: https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-deviceprocessevents-table
  10: https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-best-practices
  11: https://learn.microsoft.com/en-us/defender-xdr/api-advanced-hunting
  12: https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-limits
  13: https://learn.microsoft.com/en-us/azure/data-explorer/kql-quick-reference
  14: https://learn.microsoft.com/en-us/kusto/query/tutorials/learn-common-operators?view=microsoft-fabric
  15: https://github.com/microsoft/Microsoft-365-Defender-Hunting-Queries

## Impact
- Original: 40 references
- Consolidated: 15 references
- Reduction: 25 references (62.5%)
- Most duplicated: KQL Query Language (11 occurrences → 1)
